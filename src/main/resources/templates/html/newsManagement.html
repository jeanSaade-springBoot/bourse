<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link href="img/logo/logo.png" rel="icon">
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <title>libvol - Dashboard</title>
  <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="/css/ruang-admin.min.css" rel="stylesheet">
  <link href="/css/marquee.css" rel="stylesheet">
  <link href="/css/apexchart.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/jqx.base.css" type="text/css" />
  <link href="/css/jqx.dark.css" rel="stylesheet">
  <style>
	   .edit{
	    margin: 0.2rem 0.4rem;
	    height: 30px;
	    color: white;
	    background-color: rgb(113 157 240)!important;
	    border-color: #719DF0!important;
	    border-radius: 4px;
	    border: 1px solid transparent;
	    padding: .1rem 22%;
	}
	.update {
	    width: 85%;
	    margin: 0.2rem 0.4rem;
	    color: white;
	    background-color: rgb(101 185 106 / 20%)!important;
	    box-shadow: 0 1px 3px 0px #66bb6a!important;
	    border-color: #66bb6a!important;
	    border-radius: 4px;
	    border: 1px solid transparent;
	    padding: 1px 3px;
	    height: 30px;
	}
	.cancel{
	    margin: 0.2rem 0.2rem;
	    color: white;
	    background-color: rgb(255 67 68)!important;
	    border-color: #ff4344!important;
	    border-radius: 4px;
	    border: 1px solid transparent;
	    padding: 1px 3px;
	    height: 30px;
	    width: 90%;
	}
	.publish{
	    margin: 0.2rem 0.2rem;
	    color: white;
	    background-color: rgb(102 187 106)!important;
	    border-color: #66bb6a!important;
	    border-radius: 4px;
	    border: 1px solid transparent;
	    padding: 1px 3px;
	    height: 30px;
	    width: 90%;
	}
	.recall{
	    margin: 0.2rem 0.2rem ;
	    color: white;
	    background-color: rgb(255 164 38)!important;
	    border-color: #ffa426!important;
	    border-radius: 4px;
	    border: 1px solid transparent;
	    padding: 1px 3px;
	    height: 30px;
	    width: 90%;
	}
	  .form-control {
	    height: calc(1em + .75rem + 7px);
	    }
	    div#overlay {
	       margin: 0 0 0 40%;
	}
	   .jqx-widget-header:nth-child(16) {
	  background-color: #6495ed;
	  color:white;
	} 
	  .jqx-widget-header:nth-child(17) {
	  background-color: #ffa500;
	    color:white;
	} 
	.col-1 {
	    -webkit-box-flex: 0;
	    -ms-flex: 0 0 8.33333%;
	    flex: 0 0 8.33333%;
	    max-width: 10.33333%;
	}
	.col-2 {
	    -webkit-box-flex: 0;
	    -ms-flex: 0 0 16.66667%;
	    flex: 0 0 16.66667%;
	    max-width: 12.66667%;
	}
	::placeholder { /* Chrome, Firefox, Opera, Safari 10.1+ */
	  color: #6f7f9c;
	  opacity: 1; /* Firefox */
	}
	
	:-ms-input-placeholder { /* Internet Explorer 10-11 */
	  color: #6f7f9c;
	}
	
	::-ms-input-placeholder { /* Microsoft Edge */
	  color: #6f7f9c;
	}
	input[type="textarea"].jqx-widget-content-dark{
	  padding-left:.5rem;
	  color:#BDD1F8;
	}
.jqx-button-dark, .jqx-button-dark.jqx-fill-state-normal-dark {
    color: #f1f5fc;
    }
    input#publishNewsButton {
    background-color: #66bb6a;
    
	}
	input#triggerRobotButton {
	 background-color: #ff4344;
	}
	input#addNews {
	 background-color: #ffa426;
	}
	.jqx-notification-info, .jqx-info {
	    color: #ffffff !important;
	    text-shadow: 0 -1px 0 rgb(0 0 0 / 25%) !important;
	    background-color: #1a233a !important;
	    background-color: rgb(102 187 106 / 27%) !important;
	    border-left-color: #66bb6a !important;
	    border-right-color: #66bb6a !important;
	    border-top-color: #66bb6a !important;
	    border-bottom-color: #66bb6a !important;
	    text-align: center;
	}
	.jqx-notification {
	     padding: 0px;
	}
	.jqx-notification-close-button {
	     top: 0;
	}
	.jqx-notification-close-button-ltr {
	     right: 0;
	}
	.redColor{
	   color: red !important;
	}
  </style>
</head>

<body id="page-top">
  <div id="wrapper">
 
    <div id="content-wrapper" class="d-flex flex-column">
    <div id="content">
        <!-- TopBar -->
    <nav class="navbar navbar-expand navbar-light bg-navbar topbar static-top">
	<img id="imglogo" src="../../img/logo.png" align="absmiddle" style="height:70px;margin-left: 3%;">
	<button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
		<span class="navbar-toggler-icon"></span>
	</button>
	<!-- Collection of nav links, forms, and other content for toggling -->
	<div id="navbarCollapse" class="collapse navbar-collapse justify-content-start">		
		
		<div class="navbar-nav mr-auto">
		  <div style=" background: url(../../img/WebResource.png) top left repeat-x;     display: flex; border-radius: 0.2rem; padding: 0.2rem;">
			<a href="/bourse/home" class="nav-item nav-link"><img alt="" src="../../img/ico-home.png" class="MainMenuIcon">Home</a>
			<li class="rtbSeparator"><span class="rtbText"></span></li>
			<a href="#" class="nav-item nav-link"><img alt="" src="../../img/ico-admin.png" class="MainMenuIcon">Admin</a>
			<li class="rtbSeparator"><span class="rtbText"></span></li>
			<a href="/bourse/newsmanagement" class="nav-item nav-link active"><img alt="" src="../../img/ico-news.png" class="MainMenuIcon">news</a>
			<li class="rtbSeparator"><span class="rtbText"></span></li>
			<a href="/bourse/sovereignyields" class="nav-item nav-link"><img alt="" src="../../img/ico-database.png" class="MainMenuIcon">database</a>
			<li class="rtbSeparator"><span class="rtbText"></span></li>
			<a href="/bourse/settings" class="nav-item nav-link"><img alt="" src="../../img/ico-admin.png" class="MainMenuIcon">settings</a>
			<li class="rtbSeparator"><span class="rtbText"></span></li>
			<a href="#" class="nav-item nav-link"><img alt="" src="../../img/ico-contactus.png" class="MainMenuIcon">email</a>		
			<li class="rtbSeparator"><span class="rtbText"></span></li>
			<a href="#" class="nav-item nav-link"><img alt="" src="../../img/animatedcam2.gif" class="MainMenuIcon">video</a>
		    </div>
		</div>
			<div class="nav-item dropdown" style="width: 15%">
				<a href="#" data-toggle="dropdown" class="nav-item nav-link dropdown-toggle user-action"><i class="fas fa-user"></i><span class="ml-2 d-none d-lg-inline ">	Charbel Nacouzi</span><b class="caret"></b></a>
				<div class="dropdown-menu">
					<a href="#" class="dropdown-item"><i class="fa fa-user-o"></i> Profile</a>
					<a href="#" class="dropdown-item"><i class="fa fa-calendar-o"></i> Calendar</a>
					<a href="#" class="dropdown-item"><i class="fa fa-sliders"></i> Settings</a>
					<div class="divider dropdown-divider"></div>
					<a href="#" class="dropdown-item"><i class="material-icons">&#xE8AC;</i> Logout</a>
				</div>
		</div>
    	</div>
     </nav>
        <!-- Topbar -->
<div class="d-sm-flex align-items-center">
            	<h1 class="ml-6 text-darkorange">News Management</h1>
            </div>
        <!-- Container Fluid-->
     <div class="container-fluid" id="container-wrapper" style="display:none;">
  <div class="d-sm-flex justify-content-end "style="margin-top: 1.5rem;">
      <div id="overlay">
		     <img src="/css/images/loader.gif" alt="Loading" style=" width: 50%;"/>
		   </div>
	
     <div  style="width: 100%;  margin-right: 10%!important; height: 40px">
       <div class="form-group" id="notifcationContainer">
								       <div id="jqxNotification">
								        <div id="notificationContent">
        </div>
		         </div>
							       </div>
		  </div>			
	 <div class="mb-4 mt-4 mr-1">
        <input type="button" value="Add News" id='addNews' />
    </div>	  		      
      <div class="mb-4 mt-4 mr-1">
        <input type="button" value="Trigger Robots" id='triggerRobotButton' />
    </div>
   <div class="mb-4 mt-4">
        <input type="button" value="Publish News" id='publishNewsButton' />
    </div>
     
     </div>
           <div class="d-sm-flex  justify-content-between ">
	 
		  <div id="grid">
		  </div>
	  	    <div id="popupWindow">
            <div>NEW</div>
            <div class="col-12">
							   <form id="graphDataform1">
							    	<div class="form-group ">
									<label for="ColumnName" class="col-sm-6 col-form-label">News</label>
										<div class="col-sm-12">
											<textarea class="form-control" id="news" rows="2"></textarea>
									     </div>
								   </div>
								   <div class="form-group col-sm-2">
										 <div id='IsBold' style='text-align: left!important;'>
                                    Bold</div>
								   </div>
								   <div class="form-group col-sm-12 row">
									 <div class="col-sm-12 row" style=" margin-left: -0.1rem!important;">
									   <input id="saveNews" type="button" class="btn btn-primary mr-1 mb-1" style="margin-right: 1rem!important; color:white;" value="Save" />
								       <input id="cancel" type="button" style="margin-right: 1rem!important;" class="btn btn-light-secondary mr-1 mb-1" value="Close" />
								  <div class="form-group" id="notifcationContainerSave" style="width:70%;">
								       <div id="jqxNotificationSave">
		                                 <div id="notificationContentSave">
        </div>
		                                 </div>
							       </div>
							       </div>
								   </div>
							    </form>
								</div>
	      </div> 			

      </div>
     
      <div class="NewsBack container" style="position: fixed; bottom: 0px; left: 0px; max-width: 100%;  border: 2px; border-color: black;">
      	<div class="simple-marquee-container">
				<div class="marquee-sibling-date">
					<p id="todayDate"></p>
				</div>
				<div class="marquee-sibling">
					NEWS
				</div>
				<div class="marquee">
					<ul id="Newslist" class="marquee-content-items">
					</ul>
				</div>
				<div class="marquee-sibling-viewAll">
					 <input type="button" value="VIEW ALL" id='viewall' style="display:none;"/>
				</div>
			</div>
		</div>
      <!-- Footer -->
      <!-- Footer -->
    </div>
  </div>

 
  </div>
  </div>
  <script src="/vendor/jquery/jquery.min.js"></script>
  <script src="/js/marquee.js"></script>
  
  <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="/vendor/jquery-easing/jquery.easing.min.js"></script>
  <script src="/js/jqwidgets/jqxcore.js"></script> 
  <script src="/js/jqwidgets/jqxbuttons.js"></script> 
  <script src="/js/jqwidgets/jqxscrollbar.js"></script> 
  <script src="/js/jqwidgets/jqxtree.js"></script>
  <script src="/js/jqwidgets/jqxcheckbox.js"></script>
  <script src="/js/jqwidgets/jqxmenu.js"></script> 
  <script src="/js/jqwidgets/jqxgrid.js"></script> 
  <script src="/js/jqwidgets/jqxgrid.selection.js"></script> 
  <script src="/js/jqwidgets/jqxgrid.columnsresize.js"></script> 
  <script src="/js/jqwidgets/jqxgrid.edit.js"></script> 
  <script src="/js/jqwidgets/jqxgrid.pager.js"></script> 
  <script src="/js/jqwidgets/jqxgrid.filter.js"></script> 
  <script src="/js/jqwidgets/jqxdropdownlist.js"></script> 
  <script src="/js/jqwidgets/jqxlistbox.js"></script> 
  <script src="/js/jqwidgets/jqxdata.js"></script> 
  <script src="/js/jqwidgets/jqxwindow.js"></script>
  <script src="/js/jqwidgets/jqxinput.js"></script>
  <script src="/js/jqwidgets/jqxdatetimeinput.js"></script>
  <script src="/js/jqwidgets/jqxcalendar.js"></script>
   <script src="/js/jqwidgets/jqxnotification.js"></script>
  <script>
  var selectedRow=this;
  var groupItem;
  var subgroupsource;
  var familyItem;
  var groupsource;
  var gridsource;
  $(window).on('load', function(){
	  $('#overlay').fadeOut();
  });
  function addText(event) {
	    var targ = event.target || event.srcElement;
	    document.getElementById("TemplateText").value += targ.textContent || targ.innerText;
	}
  $(document).ready(function () {
	   $('#container-wrapper').show();
	    
	  $("#viewall").jqxButton({  theme:'dark', width: 110, height: 35,template: "primary" });
	  $("#viewall").css("display","block");
	  $("#viewall").click(function () {
			popupWindow('/bourse/allnews', 'Liberty Options - View All News', window, 1300, 600);
		  });
	  $("#saveNews").jqxButton({ theme: 'dark',height:30,width:74  });
      $("#cancel").jqxButton({ theme: 'dark',height:30,width:74 });
	  $("#jqxNotification").jqxNotification({  height: 30, width: "100%",appendContainer: "#notifcationContainer",  opacity: 0.9,
           animationOpenDelay: 800, autoClose:true , autoCloseDelay: 1000,  template: 'info'
      });
	  $("#jqxNotificationSave").jqxNotification({  height: 30, width: "100%",appendContainer: "#notifcationContainerSave",  opacity: 0.9,
          animationOpenDelay: 800, autoClose:true , autoCloseDelay: 1000,  template: 'info'
      }); 
	  $("#popupWindow").jqxWindow({
          width: '50%',    height: '38%',  resizable: false,  theme: 'dark' , isModal: true, autoOpen: false, cancelButton: $("#cancel"), modalOpacity: 0.01           
      });
	  
	  $("#IsBold").jqxCheckBox({ theme: 'dark' ,rtl: true, width: 90, height: 25});  
	  
	  $("#addNews").jqxButton({  theme:'dark', width: 120, height: 30 });
	  $("#triggerRobotButton").jqxButton({  theme:'dark', width: 120, height: 30 });
	  $("#publishNewsButton").jqxButton({  theme:'dark', width: 120, height: 30 });
      gridsource =
      {
          datatype: "json",
          datafields: [
        	  { name: 'template', type: 'string' },
        	  { name: 'isBold', type: 'string' },  
        	  { name: 'id', type: 'string' },  
        	  { name: 'robots', type: 'string' },  
        	  { name: 'columnDescription', type: 'string' },  
        	  { name: 'generationDateDate', type: 'date' },  
        	  { name: 'isPublished', type: 'string' },  
        	  
          ],
          async: true,
          url: '/admin/getunpublishednews'
      };
     
      var dataAdapter = new $.jqx.dataAdapter(gridsource, {
          downloadComplete: function (data, status, xhr) { },
          loadComplete: function (data) { },
          loadError: function (xhr, status, error) { }
      });
      var cellclassname = function (row, column, value, data) {
          var isBold = $('#grid').jqxGrid('getcellvalue', row, "isBold");
          if (isBold=="true") {
              return "redColor";
          }
      }
      // initialize jqxGrid
      $("#grid").jqxGrid(
      {
          width: '100%',
          source: dataAdapter,                
          columnsresize: true,
          theme:'dark',
          pageable: true,
          showfilterrow: true,
          filterable: true,
          columnsheight: 30,
          pagesize: 10,
          autoheight: true,
          editable: true,
          selectionmode: 'none',
          editmode: 'selectedrow',
          columns: [
        	 { text: 'Robot' ,editable:false, datafield: 'robots', width: '8%'},
        	 { text: 'Date', datafield: 'generationDateDate', width: '10%', editable:false, cellsformat: 'dd-MMM-yyyy',filtertype: 'date' }, 
        	 { text: 'News', datafield: 'template', width: '67%',   cellclassname: cellclassname,
        	   createfilterwidget: function (column, columnElement, widget) {
        	        widget.jqxInput({ width: '99%', height: 27, placeHolder: "Search" });
        	      }
           },
           { text: '',editable:false, datafield: 'Edit',width:'5%', filterable: false,cellsrenderer: function (row) {
   	    	
    		   var CheckifPublished=  $('#grid').jqxGrid('getcellvalue', row, "isPublished");
          	 if (CheckifPublished==0)
          	 {
          		 return "<input class=\"edit \" type=\"button\" onclick='Edit(" + row + ", event)' id=\"edit"+row+"\" value=\"Edit\" /><div class=\"row\" id=\"actionButtons"+row+"\" style=\"display:none\"><input  onclick='Update(" + row + ", event)' class=\"update\" type=\"button\" id=\"update\" value=\"Save\" /></div>";
                 
          	 }
          	 else
          		 return '';
          		 }
          },  
    	    { text: '',editable:false, datafield: 'Delete',width:'5%', filterable: false, cellsrenderer: function (row) {
    	    	 var CheckifPublished=  $('#grid').jqxGrid('getcellvalue', row, "isPublished");
                 if (CheckifPublished==0)
              	 {
    	    	return "<input id=\"CancelUpdate\"  onclick='Cancel(" + row + ", event)' type=\"button\"  class=\"cancel\" value=\"Delete\" />";
              	 }
    	    	 else
              		 return '';
              		 
             }
    	    },
           { text: '',editable:false, datafield: 'Recall',width:'5%', filterable: false,cellsrenderer: function (row) {
        	 var CheckifPublished=  $('#grid').jqxGrid('getcellvalue', row, "isPublished");
        	 if (CheckifPublished==0)
        	 {
        		return "<input id=\"publish\"  onclick='Publish(" + row + ", event)' type=\"button\"  class=\"publish\" value=\"Publish\" />";
              }
        	 else 
  	    	  return "<input id=\"recall\"  onclick='Recall(" + row + ", event)' type=\"button\"  class=\"recall\" value=\"Recall\" />";
      	    }
            },  
      	   
           { text: '', datafield: 'isBold', hidden: true  },
           { text: '', datafield: 'columnDescription', hidden: true  },
           { text: '', datafield: 'isPublished', hidden: true  }, 
           { text: '', datafield: 'id', hidden: true  },
           ]
         
      });
     
  });
	 function Edit(row, event) {
	     isedit=true;
	     selectedRow.editrow = row;
	   
		    	$("#grid").jqxGrid('beginrowedit', row);
		    	$("#edit"+row).css("display","none");
				$("#actionButtons"+row).css("display","contents"); 
		    	if (event) {
		    		if (event.preventDefault) {
		    			event.preventDefault();
		    		}
		    	} 
			
    }
	
  function Update(row, event) {
	 
	   isupdate=true;
	   var updatedData = $("#grid").jqxGrid('getrowdata', row);
	   selectedRow.editrow = -1;
	    $("#grid").jqxGrid('endrowedit', row);
	    var updatedData = $("#grid").jqxGrid('getrowdata', row);
	    var row = {
	    		   "id":updatedData.id,
				   "template":updatedData.template,
				   "columnDescription":updatedData.columnDescription,
				   "robots":updatedData.robots,
				   "isBold":updatedData.isBold,
				   "generationDateDate":$.jqx.dataFormat.formatdate(updatedData.generationDateDate,  'yyyy-MM-dd hh:mm:ss'),
				   "isPublished":updatedData.isPublished,
	    };
		
  	       	  $.ajax({
  	    	        type: "POST",
  	    	        contentType: "application/json",
  	    	        url: "/admin/updatenewsbyid",
  	    	        data: JSON.stringify(row),
  	    	        dataType: 'json',
  	    	        async:true,
  	    	        cache: false,
  	    	        timeout: 600000,
  	    	        success: function (data) {
  	    	        	
  	    	           $("#notificationContent").html('Data has been updated');
  	                   $("#jqxNotification").jqxNotification("open");
  	                
  	    	        
  	   },
  	    	        error: function (e) {
  	    	        	
  						  console.log("ERROR : ", e);
  	
  	    	        }
  	    	    }); 
  	       	  
	    if (event) {
	    	if (event.preventDefault) {
	    		event.preventDefault();
	    	}
	    }
	    return false;
    }
  function Cancel(row, event) {
	  isedit=false;
	  isupdate=false;
	   selectedRow.editrow = row;
    	$("#grid").jqxGrid('endrowedit', row, true);
    	
    	 var selectedrowindex = row;
         var rowscount = $("#grid").jqxGrid('getdatainformation').rowscount;
         
         var newsId = $('#grid').jqxGrid('getcellvalue', row, "id");
         $.ajax({
             type : "DELETE",
             url : "/admin/deletenewsbyid/" + newsId,
             success: function (result) {       
            	 if (selectedrowindex >= 0 && selectedrowindex < rowscount) {
 	                var id = $("#grid").jqxGrid('getrowid', selectedrowindex);
 	                var commit = $("#grid").jqxGrid('deleterow', id);
 	               $("#notificationContent").html('Data has been deleted');
	                   $("#jqxNotification").jqxNotification("open");
 	            } 
             },
             error: function (e) {
                 console.log(e);
             }
         });
   
 }
  function Recall(row, event) { 
	    var updatedData = $("#grid").jqxGrid('getrowdata', row);
	    updatedData.isPublished='0'
	    var row = {
	    		 "id":updatedData.id,
				   "template":updatedData.template,
				   "columnDescription":updatedData.columnDescription,
				   "robots":updatedData.robots,
				   "isBold":updatedData.isBold,
				   "generationDateDate":$.jqx.dataFormat.formatdate(updatedData.generationDateDate,  'yyyy-MM-dd hh:mm:ss'),
				   "isPublished":'0',
	    };
		
	    debugger;
 	       	  $.ajax({
 	    	        type: "POST",
 	    	        contentType: "application/json",
 	    	        url: "/admin/updatenewsbyid",
 	    	        data: JSON.stringify(row),
 	    	        dataType: 'json',
 	    	        async:true,
 	    	        cache: false,
 	    	        timeout: 600000,
 	    	        success: function (data) {
 	    	        	
 	    	           $("#notificationContent").html('Data has been recalled');
 	                   $("#jqxNotification").jqxNotification("open");
 	                  publishNews();
 	                  $('#grid').jqxGrid('updaterow', updatedData.uid, updatedData);
		 	           
 	   },
 	    	        error: function (e) {
 	    	        	
 						  console.log("ERROR : ", e);
 	
 	    	        }
 	    	    }); 
 	       	   
	 }
	 
 function Publish(row, event) { 
	    var updatedData = $("#grid").jqxGrid('getrowdata', row);
	    updatedData.isPublished='1'
	    var row = {
	    		  "id":updatedData.id,
				   "template":updatedData.template,
				   "columnDescription":updatedData.columnDescription,
				   "robots":updatedData.robots,
				   "isBold":updatedData.isBold,
				   "generationDateDate":$.jqx.dataFormat.formatdate(updatedData.generationDateDate,  'yyyy-MM-dd hh:mm:ss'),
				   "isPublished":'1',
	    };
		
				  $.ajax({
 	    	        type: "POST",
 	    	        contentType: "application/json",
 	    	        url: "/admin/updatenewsbyid",
 	    	        data: JSON.stringify(row),
 	    	        dataType: 'json',
 	    	        async:true,
 	    	        cache: false,
 	    	        timeout: 600000,
 	    	        success: function (data) {
 	    	        	
 	    	           $("#notificationContent").html('Data has been published');
 	                   $("#jqxNotification").jqxNotification("open");
 	             	 publishNews();
 	                  $('#grid').jqxGrid('updaterow', updatedData.uid, updatedData);
		 	           
 	   },
 	    	        error: function (e) {
 	    	        	
 						  console.log("ERROR : ", e);
 	
 	    	        }
 	    	    }); 
 	       	    
	 }
 
 function publishNews()
 {
	   $.ajax({
	        contentType: "application/json",
	        url: "/admin/getnews",
	        dataType: 'json',
	        async:true,
	        cache: false,
	        timeout: 600000,
	        success: function (data) {
	        	$("#Newslist").empty();

	        	  var ul = document.getElementById("Newslist");
					 for (i=0; i<data.length;i++)
					  {var li = document.createElement("li");
					  // li.appendChild(document.createTextNode(data[i].template.split("<img")[0]));
					  // $('#Newslist').append('<li>' + data[i].template+ '</li>');
					   if(data[i].isBold=="true")
						   $('#Newslist').append('<li><span class="red">' + data[i].template+ '</span></li>');
					   else
						   $('#Newslist').append('<li>' + data[i].template+ '</li>');
					  /*  if(data[i].isBold=="true")
					  {
					  $("#Newslist li:nth-child("+(i+1)+")").addClass("red");
					  } */
					  
					  }
					 $('#Newslist').append('<li></li>');
						var durationvalue = data.length*10000;
					    createMarquee({duration:durationvalue, padding:20});
},
	        error: function (e) {
	        	
					  console.log("ERROR : ", e);

	        }
	    });
 }
 $("#addNews").click(function () {
	  var offset = $("#grid").offset();
	  $("#popupWindow").jqxWindow({ position: { x: parseInt(offset.left)+175 , y: parseInt(offset.top)-49 } });
	  $("#popupWindow").jqxWindow('open');
 });
 $("#saveNews").click(function () {
	 
	 var a = new Date();
	 var NewRow={
		 "template":$('#news').val(),
		 "columnDescription":null,
	     "robots":'Admin',
		 "isBold":$('#IsBold').jqxCheckBox('checked'),
		 "generationDateDate":a.getFullYear()+"-"+("0" + (a.getMonth() + 1)).slice(-2)+"-"+("0" + a.getDate()).slice(-2)+" "+("0" + a.getHours()).slice(-2)+":"+("0" + a.getMinutes()).slice(-2)+":"+("0" + a.getSeconds()).slice(-2),
		 "isPublished":'0'
	  };
	 debugger;
	 if ($('#news').val()== '')
	 {
		 $("#notificationContentSave").html('News field is requiered');
		 $("#jqxNotificationSave").jqxNotification({  height: 30, width: "100%",appendContainer: "#notifcationContainerSave",  opacity: 0.9,
	          animationOpenDelay: 800,  autoClose:true , autoCloseDelay: 1000,  template: 'error'
	      });
		 $("#jqxNotificationSave").jqxNotification("open");
	 }
	 else
		{
	 $.ajax({
	        type: "POST",
	        contentType: "application/json",
	        url: "/admin/savenews",
	        data: JSON.stringify(NewRow),
	        dataType: 'json',
	        async:true,
	        cache: false,
	        timeout: 600000,
	        success: function (data) {
	        	debugger;
	        	 $('#news').val('');
	        	 $("#notificationContentSave").html('Data Inserted');
	        	 $("#jqxNotificationSave").jqxNotification({  height: 30, width: "100%",appendContainer: "#notifcationContainerSave",  opacity: 0.9,
	                 animationOpenDelay: 800, autoClose:true , autoCloseDelay: 1000,  template: 'info'
	             });
	        	 $("#jqxNotificationSave").jqxNotification("open");
	        	 var newdate =new Date(data.generationDateDate);
	        	 data.generationDateDate=newdate;
	        	 $("#grid").jqxGrid('addrow', null, data, 'first');

},
	        error: function (e) {
	        	
				  console.log("ERROR : ", e);

	        }
	    }); 
		}
});
 $("#publishNewsButton").click(function () {
	  
	 var rows = $('#grid').jqxGrid('getrows');
	  var publishedRows=[];
	  for (i=0; i<rows.length;i++)
		  {
		  publishedRows.push({
			 "id":rows[i].id,
			 "template":rows[i].template,
			 "columnDescription":rows[i].columnDescription,
		     "robots":rows[i].robots,
			 "isBold":rows[i].isBold,
			 "generationDateDate":rows[i].generationDateDate,
			 "isPublished":rows[i].isPublished
		  })
		  }
 
 	  $.ajax({
	        type: "POST",
	        contentType: "application/json",
	        url: "/robot/publishNews",
	        data: JSON.stringify(publishedRows),
	        dataType: 'text',
	        async:true,
	        cache: false,
	        timeout: 600000,
	        success: function (data) {
	        	
	       	 gridsource.url='/admin/getunpublishednews';
			 dataAdapter = new $.jqx.dataAdapter(gridsource);
			 $('#grid').jqxGrid({source:dataAdapter});
		
			   $("#notificationContent").html('News are pubished');
               $("#jqxNotification").jqxNotification("open");
},
	        error: function (e) {
	        	
				  console.log("ERROR : ", e);

	        }
	    }); 
	  
	});
  
  $("#triggerRobotButton").click(function () {
	  $('#overlay').fadeIn();
	  $.ajax({
	        contentType: "application/json",
	        url: "/robot/callRobots",
	        dataType: 'text',
	        async:true,
	        cache: false,
	        timeout: 600000,
	        success: function (data) {
	      	  $('#overlay').fadeOut();
	       	 gridsource.url='/admin/getunpublishednews';
			 dataAdapter = new $.jqx.dataAdapter(gridsource);
			 $('#grid').jqxGrid({source:dataAdapter});
			 
			 $("#notificationContent").html('Done');
             $("#jqxNotification").jqxNotification("open");
},
	        error: function (e) {
	        	
					  console.log("ERROR : ", e);

	        }
	    });
	  
	});
  $("#grid").click(function(e) {
	  e.stopPropagation(); //stops click event from reaching document
	});
	$(function (){

		   $.ajax({
	        contentType: "application/json",
	        url: "/admin/getnews",
	        dataType: 'json',
	        async:true,
	        cache: false,
	        timeout: 600000,
	        success: function (data) {
	 debugger;
				  var ul = document.getElementById("Newslist");
				 for (i=0; i<data.length;i++)
				  {var li = document.createElement("li");
				  // li.appendChild(document.createTextNode(data[i].template.split("<img")[0]));
				  // $('#Newslist').append('<li>' + data[i].template+ '</li>');
				   if(data[i].isBold=="true")
					   $('#Newslist').append('<li><span class="red">' + data[i].template+ '</span></li>');
				   else
					   $('#Newslist').append('<li>' + data[i].template+ '</li>');
				 }
				    $('#Newslist').append('<li></li>');
					var durationvalue = data.length*10000;
				    createMarquee({duration:durationvalue, padding:20});
},
	        error: function (e) {
	        	
					  console.log("ERROR : ", e);

	        }
	    });
		   
	});

		</script>
<!--   <script src="/js/demo/chart-area-demo.js"></script>   -->
</body>

</html>